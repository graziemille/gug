# 567 LAB7
# LANGUAGE: gug / Paraguayan Guaraní
# AUTHOR: Lisa Tittle Caballero
# PARTNER: Thor Wicke Monteverde



1. One Sentence Fromm Test Corpus

Last week we were able to parse sentence #20

#Sentence.20
Source: a, attested
Vetted: t
Judgment: g
Phenomena: corpus
Ha he'i Huanchi:
ha  oeHi   Juanchi
ha  o-eHi  Juanchi
and A.3-say Juan.DIM
'And Juanito says:'


This week we decided to build on that work by parsing sentence #22

#Sentence.22
Source: a, attested
Vetted: t
Judgment: g
Phenomena: corpus
Ha he'i Pirulo-pe
Ha oeHi Pirulo pe 
Ha o-eHi Pirulo=pe 
and A.3-say Pirulo=DAT
'and he said to Pirulo'


As we discussed on GoPost, implementing this sentence involved required us to: 
1. Implement ditransitives (finally!), including defining the new type and making sure appropriate inflection applied, 2. changing our implementation of case-marking adpositions so that we have separate entries for accusative and dative version of the postposition PE, only one of which is optional. 3. Making the appropriate changes to the lexicon.



- DITRANSITIVES




—— INFLECTION
Even though they have three arguments, ditransitive verb predicates (DVPs) in PG are inflected with the same prefixes as our transitive verbs. The prefixes, which our authors refer to as co-referential markers, can co-reference either the subject or the direct object (DO) of a verb.  Subjects and DOs are co-referenced with different sets of markers, which (following the conventions in our reference grammars) we refer to as A-markers and O-markers respectively.  Whether a verb receives A- or O- marking depends on its arguments’ positions in a person hierarchy. First person arguments outrank second person arguments which outrank third person arguments. If both arguments have the same person designation an A-marker is used. This gives us patterns like those below:


#Ex.70: Transitive verb with 3PER object agrees with 1SG subject. Subject drop. 
Source: author
Vetted: f
Judgment: g
Phenomena: {pro-d, agr, pn}
ahecha vakápe
ahecha vakaA pe
a-hecha vakaA=pe
A.1SG-see cow.ANIM=ACC
‘I see the cow'

#Ex.71: Transitive verb with 3PER object agrees with 2SG subject. Subject drop. 
Source: author
Vetted: f
Judgment: g
Phenomena: {pro-d, agr, pn}
rehecha vakápe
rehecha vakaA pe
re-hecha vakaA=pe
A.2SG-see cow.ANIM=ACC
‘You see the cow'

#Ex.72: Transitive verb agrees with 3PER object agrees with 3PER subject. Subject drop. 
Source: author
Vetted: f
Judgment: g
Phenomena: {pro-d, agr, pn}
ohecha vakápe
ohecha vakaA pe
o-hecha vakaA=pe
A.3-see cow.ANIM=ACC
'He sees the cow'

#Ex.73: Transitive verb with 3PER subject agrees with 1SG object.  Object drop.
Source: author
Vetted: f
Judgment: g
Phenomena: agr
chehecha vaká
chehecha vakaA
che-hecha vakaA
O.1SG-see cow.ANIM
'The cow sees me'

#Ex.74: Transitive verb with 3PER subject agrees with 2SG object. Object drop.
Source: author
Vetted: f
Judgment: g
Phenomena: agr
ndehecha vaká
ndehecha vakaA
nde-hecha vakaA
O.2SG-see cow.ANIM
'The cow sees you'

#Ex.4: Ungrammatical verb agreement with 3per object rather 3per subject.
Source: author
Vetted: f
Judgment: u
Phenomena: agr
ju'i ihecha tunich
juHi ihecha tunich
juHi i-hecha tunich
frog.ANIM O.3-see stone.INAM
*'The frog sees the stone'

The person-ranking of an indirect object (IO) does not affect co-reference marking on the verb, which we can see in Ex.50, where we have a 1st person IO, but the verb agrees with the 2nd person subject because the DO is 3rd person.

#Ex.50: Ditransitive agrees with 2SG subject. Indirect object marked with 1SG dative pronoun. S.V.IO.DO order
Source: author
Vetted: f
Judgment: g
Phenomena: {wo, agr, pn}
nde rehechauka cheve tunich
nde rehechauka cheve tunich
nde re-hecha-uka cheve tunich
2.SG.PRON.NOM A.2SG-see-CAUS 1.SG.PRON.DAT stone.INAM
'You show me the stone'

To capture this parallel behavior between transitive and intransitive verbs and make use of the inflectional rules already present in our grammar, we defined a supertype for transitive and intransitive verbs: 

gug-trans-ditrans-verb := verb-lex &
  [ INFLECTED.PERNUM-TRANS-FLAG - ].

The supertype inherits from verb-lex and adds a flag feature requiring verbs of this type to go through our pernum-trans-ditrans-lex-rule, to be considered fully inflected: 

pernum-trans-ditrans-lex-rule-super := add-only-no-ccont-rule & completive-aspect-or-perfective-aspect-or-prospective-aspect-rule-dtr & future-aspect-rule-dtr & infl-lex-rule & neg1-rule-dtr & neg2-rule-dtr &
  [ INFLECTED [ PERNUM-DYN-INTRANS-OR-PERNUM-TRANS-FLAG +,
                PERNUM-TRANS-FLAG +,
                PERNUM-DYN-INTRANS-OR-PERNUM-STAT-INTRANS-OR-PERNUM-TRANS-FLAG +,
                NEG1-FLAG #neg1,
                PERNUM-STAT-INTRANS-FLAG #pernum-stat-intrans,
                NEG2-FLAG #neg2 ],
    DTR gug-trans-ditrans-verb &
        [ INFLECTED [ NEG1-FLAG #neg1,
                      PERNUM-STAT-INTRANS-FLAG #pernum-stat-intrans,
                      NEG2-FLAG #neg2 ] ] ].

The linguistic facts of the language outlined above are captured by the individual lexical rule types of this position class which specify subject and object PERNUM values for each type.  For rule types with 1st person subjects there is no need to constrain PERNUM on the object since 1st person subjects will always outrank their objects.

1sg-a-lex-rule := pernum-trans-ditrans-lex-rule-super &
  [ SYNSEM.LOCAL.CAT.VAL.SUBJ.FIRST.LOCAL.CONT.HOOK.INDEX.PNG.PERNUM 1sg ].

1sg-a-2sg-o-lex-rule := pernum-trans-ditrans-lex-rule-super &
  [ SYNSEM.LOCAL.CAT.VAL [ SUBJ.FIRST.LOCAL.CONT.HOOK.INDEX.PNG.PERNUM 1sg,
                           COMPS.FIRST.LOCAL.CONT.HOOK.INDEX.PNG.PERNUM 2sg ] ].

1sg-a-2pl-o-lex-rule := pernum-trans-ditrans-lex-rule-super &
  [ SYNSEM.LOCAL.CAT.VAL [ SUBJ.FIRST.LOCAL.CONT.HOOK.INDEX.PNG.PERNUM 1sg,
                           COMPS.FIRST.LOCAL.CONT.HOOK.INDEX.PNG.PERNUM 2pl ] ].

1sg-o-23-a-lex-rule := pernum-trans-ditrans-lex-rule-super &
  [ SYNSEM.LOCAL.CAT.VAL [ COMPS.FIRST.LOCAL.CONT.HOOK.INDEX.PNG.PERNUM 1sg,
                           SUBJ.FIRST.LOCAL.CONT.HOOK.INDEX.PNG.PERNUM non-1st ] ].

2sg-a-3-o-lex-rule := pernum-trans-ditrans-lex-rule-super &
  [ SYNSEM.LOCAL.CAT.VAL [ SUBJ.FIRST.LOCAL.CONT.HOOK.INDEX.PNG.PERNUM 2sg,
                           COMPS.FIRST.LOCAL.CONT.HOOK.INDEX.PNG.PERNUM 3rd ] ].

2sg-o-3-a-lex-rule := pernum-trans-ditrans-lex-rule-super &
  [ SYNSEM.LOCAL.CAT.VAL [ SUBJ.FIRST.LOCAL.CONT.HOOK.INDEX.PNG.PERNUM 3rd,
                           COMPS.FIRST.LOCAL.CONT.HOOK.INDEX.PNG.PERNUM 2sg ] ].

3-a-3-o-lex-rule := pernum-trans-ditrans-lex-rule-super &
  [ SYNSEM.LOCAL.CAT.VAL [ SUBJ.FIRST.LOCAL.CONT.HOOK.INDEX.PNG.PERNUM 3rd,
                           COMPS.FIRST.LOCAL.CONT.HOOK.INDEX.PNG.PERNUM 3rd ] ].

1pl-incl-a-lex-rule := pernum-trans-ditrans-lex-rule-super &
  [ SYNSEM.LOCAL.CAT.VAL.SUBJ.FIRST.LOCAL.CONT.HOOK.INDEX.PNG.PERNUM 1pl_incl ].

1pl-excl-a-lex-rule := pernum-trans-ditrans-lex-rule-super &
  [ SYNSEM.LOCAL.CAT.VAL.SUBJ.FIRST.LOCAL.CONT.HOOK.INDEX.PNG.PERNUM 1pl_excl ].

1pl-incl-o-23-a-lex-rule := pernum-trans-ditrans-lex-rule-super &
  [ SYNSEM.LOCAL.CAT.VAL [ COMPS.FIRST.LOCAL.CONT.HOOK.INDEX.PNG.PERNUM 1pl_incl,
                           SUBJ.FIRST.LOCAL.CONT.HOOK.INDEX.PNG.PERNUM non-1st ] ].

1pl-excl-o-23-a-lex-rule := pernum-trans-ditrans-lex-rule-super &
  [ SYNSEM.LOCAL.CAT.VAL [ COMPS.FIRST.LOCAL.CONT.HOOK.INDEX.PNG.PERNUM 1pl_excl,
                           SUBJ.FIRST.LOCAL.CONT.HOOK.INDEX.PNG.PERNUM non-1st ] ].

2pl-a-3-o-lex-rule := pernum-trans-ditrans-lex-rule-super &
  [ SYNSEM.LOCAL.CAT.VAL [ SUBJ.FIRST.LOCAL.CONT.HOOK.INDEX.PNG.PERNUM 2pl,
                           COMPS.FIRST.LOCAL.CONT.HOOK.INDEX.PNG.PERNUM 3rd ] ].

2pl-o-3-a-lex-rule := pernum-trans-ditrans-lex-rule-super &
  [ SYNSEM.LOCAL.CAT.VAL [ COMPS.FIRST.LOCAL.CONT.HOOK.INDEX.PNG.PERNUM 2pl,
                           SUBJ.FIRST.LOCAL.CONT.HOOK.INDEX.PNG.PERNUM 3rd ] ].

These individual lexical rule types are instantiated in irules.tdl as follows:

1sg-a-prefix :=
%prefix (* a)
1sg-a-lex-rule.

1sg-a-2sg-o-prefix :=
%prefix (* ro)
1sg-a-2sg-o-lex-rule.

1sg-a-2pl-o-prefix :=
%prefix (* po)
1sg-a-2pl-o-lex-rule.

1sg-o-23-a-prefix :=
%prefix (* che)
1sg-o-23-a-lex-rule.

2sg-a-3-o-prefix :=
%prefix (* re)
2sg-a-3-o-lex-rule.

2sg-o-3-a-prefix :=
%prefix (* nde)
2sg-o-3-a-lex-rule.

3-a-3-o-prefix :=
%prefix (* o)
3-a-3-o-lex-rule.

1pl-incl-a-prefix :=
%prefix (* ja)
1pl-incl-a-lex-rule.

1pl-excl-a-prefix :=
%prefix (* ro)
1pl-excl-a-lex-rule.

1pl-incl-o-23-a-prefix :=
%prefix (* nNande)
1pl-incl-o-23-a-lex-rule.

1pl-excl-o-23-a-prefix :=
%prefix (* ore)
1pl-excl-o-23-a-lex-rule.

2pl-a-3-o-prefix :=
%prefix (* pe)
2pl-a-3-o-lex-rule.

2pl-o-3-a-prefix :=
%prefix (* pende)
2pl-o-3-a-lex-rule.


— CASE-MARKING ADPOSITIONS
The indirect objects of DVPs are marked with an obligatory dative marker. These arguments can take the form of either a dative pronoun or an NP combined with the case-marking postposition ’pe.’  












— CHANGES TO THE LEXICON

Since we defined proper nouns last week, adding Pirulo was simple.  We just added the following new entry to lexicon.tdl:

	Pirulo := proper-noun-lex &	
	  [ STEM < “Pirulo” >,
	    SYNSEM.LKEYS.KEYREL.CARG “Pirulo” ].

Which inherits from our proper-noun-lex defined in PG.tdl:

	proper-noun-lex := non-poss-com-noun-lex & no-spr-noun-lex & com-anim-noun-lex & 
			   named-relation.

We also up dated our entry for eHi so that instead of instantiating trans-verb-lex, it instantiates ditrans-verb-lex:

	eHi := ditrans-verb-lex &
	  [ STEM <"eHi">,
	    SYNSEM.LKEYS.KEYREL.PRED "_say_v_rel"]. 



— END STATE
  
Our new sentence now parses with our target semantics. We also get one additional parse, with the meaning “He said Pirulo to someone,” because the accusative marker is also written as ‘pe,’ and in our free word order language, this makes #22 ambiguous.  

#Sentence.22
Source: a, attested
Vetted: t
Judgment: g
Phenomena: corpus
Ha he'i Pirulo-pe
Ha oeHi Pirulo pe 
Ha o-eHi Pirulo=pe 
and A.3-say Pirulo=DAT
'and he said to Pirulo'

We are able to generate from both of our parses. When we generate from the tree where =pe is identified as an accusative marker we get four parses: both Verb/Argument orders, each with a pe-marked and non-pe-marked option.  When we generate from the tree where =pe is identified as a dative marker, we correctly get only two parses: ‘ha Pirulo pe oeHi,’ and ‘ha oeHi Pirulo pe.’  



4. More improvements to the grammar

—UPDATES FROM LAST WEEK

We are now defining ‘-eHi’ as a ditransitive verb in the lexicon, but because dative marking is obligatory for indirect objects, Juanchi can only be the subject or direct object of the predicate in 20—which is the same ambiguity we saw last week when ‘-eHi’ was instantiated as a transitive verb. 

#Sentence.20
Source: a, attested
Vetted: t
Judgment: g
Phenomena: corpus
Ha he'i Huanchi:
ha  oeHi   Juanchi
ha  o-eHi  Juanchi
and A.3-say Juan.DIM
'And Juanito says:'

Also, last week when we generated from these parses we got a lot of sentences.  Some of this generation was well-formed and due to the fact that we had not specified a default for underspecified aspect values. But generating from our coordinated examples also generated a lot of options with ‘pa’ and ‘piko,’ e.g. ‘ha oeHi ha Juanchi piko.’ With changes made to semi.vpm and our coordination rules (described below) we have managed to get some really well behaved generation. 





5. Statement of the current overage of the grammar over your testsuite (using number you can get from Analyze|Coverage and Analyze|Overgeneration in [incr tsdb()]) and a comparison between your baseline testsuite run and your final one for this lab (see Compare|Competence).

—Corpus Stats

Analyze | Coverage
	Total Items: 21
	Positive Items: 21
	Word String 0: 6.14
	Lexical Items 0: 6.00
	Distinct Analyses: 3.00
	Total Results: 1
	Overall Coverage: 4.8

Analyze | Overgeneration
	Total Items: 0
	Negative Items: 0
	Word String 0: 0
	Lexical Items 0: 0
	Distinct Analyses: 0 
	Total Results: 0
	Overall Coverage: 100

Comparison of baseline(gold-lab6) and final version of this lab 
(Compare | Competence)

	Baseline
		lexical 0:  .38
		analyses 0: 0.0
		in 0:       0.0
		out 0:      100.0

	New
		lexical 0:  .53
		analyses 0: 3.00
		in 0:       4.8
		out 0:      100.0

We have achieved our goal of parsing one more sentence from our corpus this week:

#Sentence.20
Source: a, attested
Vetted: t
Judgment: g
Phenomena: corpus
Ha he'i Huanchi:
ha  oe   Juanchi
ha  o-e  Juanchi
and A.3-say Juan.DIM
'And Juanito says:'

Which as noted earlier in the write-up is correctly parsing with three possible readings. 


--TestSuite General Stats

Analyze | Coverage
	Total Items: 211
	Positive Items: 138
	Word String 0: 2.99
	Lexical Items 0: 4.84
	Distinct Analyses: 2.96
	Total Results: 113
	Overall Coverage: 81.9

Analyze | Overgeneration
	Total Items: 211
	Negative Items: 73
	Word String 0: 2.97
	Lexical Items 0: 4.68
	Distinct Analyses: 1.00
	Total Results: 1
	Overall Coverage: 1.4

Comparison of baseline(gold-lab6) and final version of this lab 
(Compare | Competence)

	Baseline
		lexical 0:  1.46
		analyses 0: 2.76
		in 0:       76.8
		out 0:      6.8

	New
		lexical 0:  1.52
		analyses 0: 2.94
		in 0:       81.9
		out 0:      1.4


General analysis

We see an increase in coverage over our testsuite from 76.8 to 81.9.  A lot of that jump is in our analysis of longer sentences (i-length in [5-10|) where our performance jumped from 60.9 to 78.3.  The jump in shorter sentences was more modest from 80.0 to 82.6.  

We also see an increase in the number of distinct analyses with our new grammar, but this is actually to be expected for two reasons.  First, fixing our n-bar-predicate rule resulted in a lot more legitimate ambiguity, and second, as noted above we are parsing a larger percentage of our long sentences which in Guarani tend to have larger numbers of legitimate parses.

One example is 202, seen below, where we have 4 legitimate parses even without accounting for asyndenton coordination which interacts with the n-bar-predicate rule to produce 6 more. That said we were still able to constrain coordination a bit more and reduce the number of parses on that sentence by 2 even with the changes this week, from 12 to 10 total.

#Ex.202: Embedding of interrogative clause
Source: e
Vetted: f
Judgment: g
Phenomena: emb-d
aikuua ohechaha ju'i vakaA
aikuua ohecha ha juHi vakaA
a-ikuua o-hecha=ha juHi vakaA
A.1SG-know A.3-see=COMPL frog cow
'I know that somebody sees the frog's cow' / ' I know that the frog's cow sees it' / 'I know that the frog sees the cow' / 'I know that the cow sees the frog'

Even short sentences can be multiply ambiguous, particularly when we have to NP’s next to each other as we see in 193.  Here we can have the frog seeing the cow, the cow seeing the frog, the frog’s cow being seen, or the frog’s cow seeing something.  For these types of sentences we generally saw an increase in parses from 8-10, with the 2 extra parses attributed to the aforementioned changes to our n-bar-predicate rule and the interaction between it and coordination.  

#Ex.193 Transitive verb agrees with 3per subject. No marking on animate object. VSO word order. No determiners, underspecified number. Ambiguous.
Source: author
Vetted: f
Judgment: g
Phenomena: wo
ohecha ju'i vaká
ohecha juHi vakaA
o-hecha juHi vakaA
O.3-see frog.ANIM.NOM cow.ANIM
'The frogs see the cows'

In Ex. 162 the additional ambiguity is the result of new lexical ambiguity.  We have a new scopal-modifier with the form “ha” which is also the form of complementizer clitic AND the form used for conjunction.  The ambiguity between scopal modifier and conjunction leads to increase the readings from 4 to 8 but all the readings look reasonable. 

#Ex.162: Use of 'and' coordination with nominal constituents
Source: author
Vetted: f
Judgment: g
Phenomena: {crd, wo}
aguara ha jagua okañy
aguara ha jagua okanNy
aguara ha jagua o-kanNy
fox.ANIM.NOM and dog.ANIM.NOM A.3-hide
'the fox and the dog hid'

As a further frame of reference we also compared our results to our grammar from this Thursday, after we had made some major changes but before we had managed to patch many of our leaks. Thursday’s grammar was showing 3.89 analyses on average with a 6.45 average for longer sentences, which were able to get down to 2.94 and 3.44 respectively.

In particular 201 and 202, which you may remember as being the sentences with 17 and 20 parses respectively now have only 10 distinct analyses each, which as you can see from my breakdown of 202 above is actually a reasonable number for sentences of this length particularly when there are to NPs in a row.

#Ex.201: Embedding of interrogative clause
Source: e
Vetted: f
Judgment: g
Phenomena: emb-q
aporandu ohechapa ju'i vakaA
aporandu ohecha pa juHi vakaA
a-porandu o-hecha=pa juHi vakaA
A.1SG-ask A.3-see=Q frog cow
'I ask if somebody sees the frog's cow'/ ' I ask if the frog's cow sees it' / 'I ask if the frog sees the cow' / 'I ask if the cow sees the frog'

#Ex.202: Embedding of interrogative clause
Source: e
Vetted: f
Judgment: g
Phenomena: emb-d
aikuua ohechaha ju'i vakaA
aikuua ohecha ha juHi vakaA
a-ikuua o-hecha=ha juHi vakaA
A.1SG-know A.3-see=COMPL frog cow
'I know that somebody sees the frog's cow' / ' I know that the frog's cow sees it' / 'I know that the frog sees the cow' / 'I know that the cow sees the frog'

Adding some additional constraints to our head-adj-int rule reduced the parses on sentences like 22 and 26 by about half, from 9 to 5 in the first case and from 13 to 6 in the second. Furthermore the parses that remain look legitimate.

#Ex.22 Transitive verb agrees with 3per subject. Accusative marking on animate object. SVO word order. No determiners, underspecified number.
Source: author
Vetted: f
Judgment: g
Phenomena: {wo, agr, c}
ju'i ohecha vakápe
juHi ohecha vakaA pe
juHi o-hecha vakaA=pe
frog.ANIM.NOM O,3-see cow.ANIM=ACC
'The frogs sees the cows'

#Ex.26: Transitive verb agrees with 3per subject. Accusative marking on animate object. VSO word order. No determiners, underspecified number.
Source: author
Vetted: f
Judgment: g
Phenomena: {wo, agr, c}
ohecha ju'i vakápe
ohecha juHi vakaA pe
o-hecha juHi vakaA=pe
A.3-see frog.ANIM.NOM cow.ANIM=ACC
'The frog sees the cow'


Our ill-formed sentence is the same example as in previous weeks were we have not yet encoded that “hand” has to have a possessor or possessive marking, and cannot occur with a  determiner like la/lo. That should be easy to handle with what we have in place so we will likely get to that next week. We are also hoping to tackle ditransitives for next week which should reduce our number of errors significantly.  


——Details 

—Intersection between readings and MRS

When we look at the intersection between readings and differences in MRS we see some really interesting changes that further complicate the results above.  There are many examples (over 15) where there are no readings in common. This is even true many distinct analyses available for both weeks. For example sentence 202 which we looked at above had 12 parses last week and has 10 this week, but NONE of those readings overlap. 

Our simple go-to sentence ‘juhi ohecha tunich’ has the two traditional readings in common with last week, “the frog sees the stone” and the “the stone sees the frog”  but the semantics for all of our coordinated results are different which shows the effect of not loosing our semantics, which was happening because non-local information was not getting passed up through our coordination rules. 

#Ex.3:  Transitive verb. 3Per subject verb agreement. Inanimate object.
Source: author
Vetted: f
Judgment: g
Phenomena: {wo, agr, c}
ju'i ohecha tunich
juHi ohecha tunich
juHi o-hecha tunich
frog.ANIM A.3-see stone.INAM
'The frog sees the stone' / 'The stone sees the frog' 

Sentence 186 went from 4 to 6 readings, with 0 in common. 5 of those parses involve coordination, so the lack of overlap is expected given the problem outlined above, but it also tells me we weren’t getting the semantics right for the target reading of “my mother’s dog walks” either.    

#Ex.186: Possessive affixation combined with possessive phrase rule. 
Source: author
Vetted: f
Judgment: g
Phenomena: poss
chesy jagua oguata
chesy jagua oguata
che-sy jagua o-guata
1SG.POS-mother dog A.3-walk
'My mother's dog walks' 

Finally we can see the effects of the corrected n-bar-predicate rule in the semantics #195, which had one reading for both grammars but with different semantics:

#Ex.195: NP predicate, possessive marking
Source: author
Vetted: f
Judgment: g
Phenomena: cop
hi'ára
iaAra
i-aAra
POSS.3-day
'It is his/her day' 
